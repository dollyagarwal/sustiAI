<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoSphere Ltd - Comparative Event Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #28a745;
            --text-color: #333;
            --background-color: #f4f7f6;
            --font-family: 'Arial', sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header img {
            height: 50px;
            width: auto;
            border-radius: 50%;
            background-color: white;
            padding: 5px;
        }

        .header h1 {
            margin: 0;
            font-size: 24px;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }

        h2, h3, h4, h5, h6 {
            color: var(--primary-color);
            margin-top: 1.5em;
            margin-bottom: 0.8em;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 5px solid var(--primary-color);
        }

        .kpi-card .value {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
            display: block;
        }

        .kpi-card .label {
            font-size: 0.9em;
            color: #666;
            display: block;
        }

        .kpi-card .unit {
            font-size: 0.8em;
            color: #888;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background:#fff;
            padding:20px;
            border-radius:8px;
            box-shadow:0 2px 4px rgba(0,0,0,0.1);
        }

        .narrative-content {
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .narrative-content ul, .narrative-content ol {
            padding-left: 20px;
        }

        .narrative-content li {
            margin-bottom: 0.5em;
        }

        .narrative-content p {
            margin-bottom: 1em;
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTbBL29Jawxl9ELLRe8K5Qgy0udooluQC2NQQ&s" alt="EcoSphere Ltd Logo">
        <h1>EcoSphere Ltd - Comparative Event Report</h1>
    </div>

    <div class="container">
        <h2 style="color: var(--primary-color);">Overall Performance Summary</h2>
        <div class="kpi-grid">
            <div class="kpi-card">
                <span class="value">7</span>
                <span class="label">Total Events Held</span>
                <span class="unit">events</span>
            </div>
            <div class="kpi-card">
                <span class="value">13,062</span>
                <span class="label">Total Attendees Impacted</span>
                <span class="unit">pax</span>
            </div>
            <div class="kpi-card">
                <span class="value">507,661.90</span>
                <span class="label">Total Portfolio Emissions</span>
                <span class="unit">kg CO₂e</span>
            </div>
            <div class="kpi-card">
                <span class="value">72,523.13</span>
                <span class="label">Avg. Emissions per Event</span>
                <span class="unit">kg CO₂e/event</span>
            </div>
            <div class="kpi-card">
                <span class="value">38.87</span>
                <span class="label">Avg. Emissions per Attendee</span>
                <span class="unit">kg CO₂e/pax</span>
            </div>
        </div>

        <h2 style="color: var(--primary-color);">Event Performance Visualizations</h2>
        <div class="charts-grid">
            <div class="chart-card" style="background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1);"><h3>Total Emissions by Event Type</h3><div style="position: relative; height: 350px; width: 100%;"><canvas id="chart_0"></canvas></div></div>
            <div class="chart-card" style="background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1);"><h3>Emissions Intensity per Attendee by Event</h3><div style="position: relative; height: 350px; width: 100%;"><canvas id="chart_1"></canvas></div></div>
            <div class="chart-card" style="background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1);"><h3>Emissions Intensity per Square Foot by Event</h3><div style="position: relative; height: 350px; width: 100%;"><canvas id="chart_2"></canvas></div></div>
        </div>

        <div class="narrative-content">
            <h2>Executive Summary</h2>
            <p>EcoSphere Ltd has successfully organized 7 events, engaging a total of 13,062 attendees. The company's total carbon footprint from these events amounts to approximately 507.7 tonnes CO₂e, with an average emission of 72.5 tonnes CO₂e per event and 38.87 kg CO₂e per attendee. This report provides a comparative analysis of these events, highlighting key areas for environmental performance improvement.</p>
            <h3>Key Insights</h3>
            <ul>
                <li><strong>Highest Emission Contributors:</strong> The 'Innovation Workshop' (ID 6) and 'Tech Expo' (ID 5) are the top two events in terms of total emissions, accounting for 90,079.19 kg CO₂e and 89,438.72 kg CO₂e, respectively, significantly contributing to the overall portfolio footprint.</li>
                <li><strong>Varying Attendee Intensity:</strong> The 'Innovation Workshop' (ID 6) recorded the highest emissions per attendee at 834.07 kg CO₂e/pax, indicating a high impact per individual. In contrast, 'Tech Expo' (ID 3) achieved a much lower intensity of 119.00 kg CO₂e/pax, suggesting that larger events can still be managed with relatively lower per-attendee emissions through efficient planning.</li>
                <li><strong>Venue Efficiency Disparities:</strong> The 'Innovation Workshop' (ID 6) also showed the highest emissions per square foot (2.00 kg CO₂e/sqft), pointing to potential inefficiencies in venue energy consumption or space utilization compared to other events like 'Tech Expo' (ID 3) which had 0.99 kg CO₂e/sqft.</li>
                <li><strong>Lower Impact Operational Meetings:</strong> 'Quarterly Business Review' events consistently demonstrated lower total emissions and better intensity metrics, suggesting more sustainable operational models for internal or smaller-scale gatherings.</li>
            </ul>
            <h3>Recommendations</h3>
            <ol>
                <li><strong>Targeted Emission Reduction for High-Impact Events:</strong> Implement specific strategies to reduce emissions for 'Innovation Workshop' and 'Tech Expo' events. This could involve optimizing travel logistics for attendees and speakers, enhancing energy efficiency at venues, and sourcing sustainable catering options.</li>
                <li><strong>Optimize Venue and Resource Utilization:</strong> Conduct a thorough review of venue selection and resource allocation for events with high emissions per square foot, like 'Innovation Workshop' (ID 6). Explore options such as right-sizing venues, utilizing renewable energy sources, and implementing robust waste management programs.</li>
                <li><strong>Promote Virtual/Hybrid Engagement for Large Audiences:</strong> For events with high physical attendee impact, integrate more robust virtual or hybrid participation options to reduce travel-related emissions and expand reach without increasing the physical footprint. This could particularly benefit events like 'Innovation Workshop' (ID 6).</li>
                <li><strong>Standardize Best Practices:</strong> Analyze the operational models of events with lower intensity metrics, such as 'Tech Expo' (ID 3) and 'Quarterly Business Review' (ID 7), to identify and standardize best practices for sustainable event management across all EcoSphere Ltd events.</li>
            </ol>
        </div>
    </div>

    <script>
        const primaryColor = "#28a745";
        const chartsConfig = [
            {
              "title": "Total Emissions by Event Type",
              "type": "bar",
              "labels": [
                "Innovation Workshop",
                "Tech Expo",
                "Tech Expo",
                "Innovation Workshop",
                "Annual Strategy Meeting",
                "Quarterly Business Review",
                "Quarterly Business Review"
              ],
              "data": [
                90079.19,
                89438.72,
                74127.0,
                68489.66,
                64898.38,
                63824.27,
                56804.68
              ],
              "color_scheme": "primary"
            },
            {
              "title": "Emissions Intensity per Attendee by Event",
              "type": "bar",
              "labels": [
                "Innovation Workshop",
                "Tech Expo",
                "Tech Expo",
                "Innovation Workshop",
                "Annual Strategy Meeting",
                "Quarterly Business Review",
                "Quarterly Business Review"
              ],
              "data": [
                834.07,
                392.28,
                119.0,
                219.52,
                352.71,
                574.99,
                189.35
              ],
              "color_scheme": "primary"
            },
            {
              "title": "Emissions Intensity per Square Foot by Event",
              "type": "bar",
              "labels": [
                "Innovation Workshop",
                "Tech Expo",
                "Tech Expo",
                "Innovation Workshop",
                "Annual Strategy Meeting",
                "Quarterly Business Review",
                "Quarterly Business Review"
              ],
              "data": [
                2.0,
                1.63,
                0.99,
                1.37,
                1.44,
                1.28,
                1.14
              ],
              "color_scheme": "primary"
            }
          ];

        chartsConfig.forEach((chart, index) => {
            const ctx = document.getElementById(`chart_${index}`).getContext('2d');
            let datasets = [{
                label: chart.title,
                data: chart.data,
                borderWidth: 1
            }];

            if (chart.type === 'line') {
                datasets[0].borderColor = primaryColor;
                datasets[0].backgroundColor = 'transparent';
                datasets[0].fill = false;
            } else if (chart.type === 'bar') {
                datasets[0].backgroundColor = primaryColor;
                datasets[0].borderColor = primaryColor;
            } else if (chart.type === 'doughnut') {
                const colors = [
                    primaryColor,
                    '#6c757d', // A neutral gray
                    '#ced4da', // Light gray
                    '#adb5bd', // Medium gray
                    '#495057'  // Darker gray
                ];
                datasets[0].backgroundColor = chart.labels.map((_, i) => colors[i % colors.length]);
                datasets[0].borderColor = '#fff';
            }

            new Chart(ctx, {
                type: chart.type,
                data: {
                    labels: chart.labels,
                    datasets: datasets
                },
                options: {
                    maintainAspectRatio: false,
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false // Hide dataset label as title is already prominent
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>